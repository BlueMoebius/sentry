{% extends "sentry/projects/manage.html" %}

{% load i18n %}
{% load sentry_helpers %}
{% load sentry_plugins %}

{% block title %}{% trans "Manage API Keys" %} | {{ block.super }}{% endblock %}

{% block inner %}
    <div class="page-header">
        {% if can_add_key %}
            <a href="{% url 'sentry-new-project-key' project.team.slug project.slug %}" class="btn pull-right btn-primary btn-sm" style="position: relative; top: -6px;">{% trans "Generate New Key" %}</a>
        {% endif %}
        <h3>
            {% trans "Manage API Keys" %}
        </h3>
    </div>
    <table class="table table-bordered">
        <colgroup>
            <col/>
            <col width="100px"/>
        </colgroup>
        <thead>
            <tr>
                <th colspan="2">{% trans "API Key" %}</th>

            </tr>
        </thead>
        <tbody>
            {% for key in key_list %}
                <tr>
                    <td>
                        {% if key.label %}
                            <a href="{% url 'sentry-edit-project-key' project.team.slug project.slug key.id %}">{{ key.label }}</a>
                        {% else %}
                            <a href="{% url 'sentry-edit-project-key' project.team.slug project.slug key.id %}">{{ key.public_key }}</a> {% if key.user %} &mdash; {{ key.user.email }}{% endif %}
                        {% endif %}<br>
                        <input class="form-control" value="{{ key.dsn_private }}" style="margin: 4px 0 6px">
                        {% if key.user_added %}
                            <small><small>Added by {{ key.user_added.email }} ({{ key.date_added|timesince }})</small></small>
                        {% endif %}
                    </td>
                    <td style="text-align:center; vertical-align:middle;">
                        {% if key.can_remove %}
                            <form method="POST" action="{% url 'sentry-remove-project-key' project.team.slug project.slug key.id %}" style="display:inline">
                                {% csrf_token %}
                                <input type="submit" class="btn btn-danger btn-sm" value="{% trans "Revoke" %}">
                            </form>
                        {% else %}
                            &mdash;
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
